define(["app/plugins/sdk","lodash"],function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=131)}({131:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationsQueryCtrl=e.QueryOptionsCtrl=e.ConfigCtrl=e.QueryCtrl=e.Datasource=void 0;var r=n(132),i=n(138),s=function(){function t(){}return t.templateUrl="datasources/live/partials/config.html",t}(),o=function(){function t(){}return t.templateUrl="datasources/live/partials/query.options.html",t}(),a=function(){function t(){}return t.templateUrl="datasources/live/partials/annotations.editor.html",t}();e.Datasource=r.PcpLiveDatasource,e.QueryCtrl=i.GenericDatasourceQueryCtrl,e.ConfigCtrl=s,e.QueryOptionsCtrl=o,e.AnnotationsQueryCtrl=a},132:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PcpLiveDatasource=void 0;var r=c(n(133)),i=n(134),s=c(n(135)),o=u(n(37)),a=u(n(137));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function c(t){return t&&t.__esModule?t:{default:t}}var p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},h=function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},l=function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},f=function(){function t(t,e,n,r,i){this.instanceSettings=t,this.name=t.name,this.q=e,this.backendSrv=n,this.templateSrv=r,this.variableSrv=i,this.withCredentials=t.withCredentials,this.headers={"Content-Type":"application/json"},"string"==typeof t.basicAuth&&t.basicAuth.length>0&&(this.headers.Authorization=t.basicAuth),this.poller=new s.default(n);this.container_name_filter=function(t){return!0}}return t.prototype.buildQueryTargets=function(t){var e=this;return t.targets.filter(function(t){return"select metric"!==t.target}).map(function(n){var i=r.default.isUndefined(n.data)?null:n.data;("string"==typeof i&&""===i.trim()&&(i=null),null!==i)&&(null!==i.match(/("(\$.+?)")/g)&&i.match(/("(\$.+?)")/g).map(function(n){var r=e.templateSrv.replace(n,t.scopedVars,"json");r!==n&&(i=i.replace(n,r.substring(1,r.length-1)))}),i=JSON.parse(i));return{data:i,target:e.templateSrv.replace(n.target,t.scopedVars,"regex"),displayName:e.templateSrv.replace(n.displayName,t.scopedVars,"regex"),refId:n.refId,hide:n.hide,type:n.type}})},t.prototype.getVariables=function(){var t={};return this.variableSrv.variables?(this.variableSrv.variables.forEach(function(e){var n=e.current.value;("$__all"===n||r.default.isEqual(n,["$__all"]))&&(n=null===e.allValue?e.options.slice(1).map(function(t){return t.value}):e.allValue),t[e.name]={text:e.current.text,value:n}}),t):{}},t.prototype.getConfiguredEndpoint=function(){var t=this.getVariables();if("_proto"in t&&"_host"in t&&"_port"in t){var e=t._proto.value+"://"+t._host.value+":"+t._port.value;return"_container"in t&&(e+="::"+t._container.value),e}e=this.instanceSettings.url;return this.instanceSettings.jsonData.container&&(e+="::"+this.instanceSettings.jsonData.container),e},t.prototype.targetName=function(t,e,n,r){if(["bcc.runq.latency","bcc.disk.all.latency"].includes(r)){var i=t[e];return i.split&&i.split("-")[1]||i}var s=n.length<=1?r:r.substring(o.sharedPrefixLength(n.map(function(t){return t.target}))),a=t&&Object.values(t)[0],u=t&&Object.values(t).every(function(t){return t===a});return t[e]?n.length>1?u?s:s+" ("+t[e]+")":t[e]:s},t.prototype.doRequest=function(t){return h(this,void 0,void 0,function(){var e;return l(this,function(n){switch(n.label){case 0:return e=p({},t,{withCredentials:this.withCredentials,headers:this.headers}),[4,this.backendSrv.datasourceRequest(e)];case 1:return[2,n.sent()]}})})},t.prototype.testDatasource=function(){return h(this,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,this.poller.getMetrics(this.getConfiguredEndpoint(),["pmcd.version"])];case 1:return t.sent()?[2,{status:"success",title:"Success",message:"Data source configured successfully. If you wish to override the PCP endpoint for specific dashboards, you can use the  _host, _port, _proto, (and optionally _container) variables."}]:[2,{status:"error",title:"Additional configuration required",message:"Could not connect to the specified url. To use this data source, please configure the _host, _port, _proto, (and optionally _container) dashboard variables."}]}})})},t.prototype.annotationQuery=function(t){return h(this,void 0,void 0,function(){return l(this,function(t){return[2,[]]})})},t.prototype.metricFindQuery=function(t){return h(this,void 0,void 0,function(){var e;return l(this,function(n){switch(n.label){case 0:return"containers.name"!==(e=this.templateSrv.replace(t,null,"regex"))?[3,2]:[4,this.poller.getMetrics(this.getConfiguredEndpoint(),[t])];case 1:return[2,n.sent().data.values[0].instances.map(function(t){return t.value}).filter(this.container_name_filter).map(function(t){return{text:t,value:t}})];case 2:return[2,this.poller.metricNames.filter(function(t){return!e||t.includes(e)}).map(function(t){return{text:t,value:t}})]}})})},t.prototype.query=function(t){return h(this,void 0,void 0,function(){var e,n,s,u,c,h,f,v,d,y,m,g,b,x,w,M,k,O,E,_,T,C,A,P,N,S,j,I,q,R;return l(this,function(l){if((e=t).targets=this.buildQueryTargets(t),n=new i.Parser,this.templateSrv.getAdhocFilters?e.adhocFilters=this.templateSrv.getAdhocFilters(this.name):e.adhocFilters=[],t.scopedVars=p({},this.getVariables(),t.scopedVars),s=t.targets,u=this.getConfiguredEndpoint(),c=u.split("::")[1]||null,h=s.map(function(t){return t.target}).map(function(t){return n.parse(t)}),f=o.flatMap(function(t){return t.variables({withMembers:!0})},h),this.poller.ensurePolling(u,f),v=this.poller.collectData(u,f),d=a.transformAfterCollected(v,c),y=[],d[0])for(m=0,g=s;m<g.length;m++){for(b=g[m],x=[],w=n.parse(b.target),M=function(t){for(var e=t[0],n=[],i=function(t){var i=d.map(function(n){var r=n.datas.find(function(t){return t[0]===e}),i=r&&r[1]&&r[1].find(function(e){return e.instance===t.instance});return{metric:n.metric,value:i&&i.value}}),s={};f.forEach(function(t){return r.default.set(s,t,0)}),i.forEach(function(t){return r.default.set(s,t.metric,t.value)});var o=w.evaluate(s);n.push({instance:t.instance,instanceName:t.instanceName,value:o})},s=0,o=t[1];s<o.length;s++){i(o[s])}x.push([e,n])},k=0,O=d[0].datas;k<O.length;k++)P=O[k],M(P);y.push({datas:x,endpoint:u,metric:b.displayName||b.target})}for(E=[],_=function(t){var e={};t.datas.forEach(function(t){return t[1].forEach(function(t){return e[t.instance]=t.instanceName})});for(var n=function(n){for(var r=T.targetName(e,n,s,t.metric),i=[],o=0,a=t.datas;o<a.length;o++){var u=a[o],c=u[0],p=u[1].find(function(t){return t.instance==n});if(p){var h=p.value;i.push([h,c])}}E.push({metric:t.metric,instance:n,target:r,datapoints:i})},r=0,i=Object.keys(e);r<i.length;r++){n(i[r])}},T=this,C=0,A=y;C<A.length;C++)P=A[C],_(P);if(s.every(function(t){return"table"===t.type})){for("table",S=s.map(function(t){return{text:t.target,type:"string"}}),j=[],E.forEach(function(t){return j.push([])}),I=0;I<j.length;I++)for(q=function(t){var e=""+I,n=S[t].text,r=E.find(function(t){return t.instance===e&&t.metric===n});if(r){var i=r.datapoints;j[I][t]=i[i.length-1][0]}},R=0;R<S.length;R++)q(R);N=[{columns:S,rows:j,type:"table"}]}else N=E.map(function(t){return{target:t.target,datapoints:t.datapoints}});return[2,{data:N}]})})},t}();e.PcpLiveDatasource=f},133:function(t,n){t.exports=e},134:function(t,e,n){t.exports=function(){"use strict";var t="INUMBER",e="IOP1",n="IOP2",r="IOP3",i="IVAR",s="IFUNCALL",o="IEXPR",a="IMEMBER";function u(t,e){this.type=t,this.value=null!=e?e:0}function c(t){return new u(e,t)}function p(t){return new u(n,t)}function h(t){return new u(r,t)}function l(u,c){for(var p,h,f,v,d=[],y=0;y<u.length;y++){var m=u[y],g=m.type;if(g===t)"number"==typeof m.value&&m.value<0?d.push("("+m.value+")"):d.push("string"==typeof(w=m.value)?JSON.stringify(w).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):w);else if(g===n)h=d.pop(),p=d.pop(),v=m.value,c?"^"===v?d.push("Math.pow("+p+", "+h+")"):"and"===v?d.push("(!!"+p+" && !!"+h+")"):"or"===v?d.push("(!!"+p+" || !!"+h+")"):"||"===v?d.push("(String("+p+") + String("+h+"))"):"=="===v?d.push("("+p+" === "+h+")"):"!="===v?d.push("("+p+" !== "+h+")"):d.push("("+p+" "+v+" "+h+")"):d.push("("+p+" "+v+" "+h+")");else if(g===r){if(f=d.pop(),h=d.pop(),p=d.pop(),"?"!==(v=m.value))throw new Error("invalid Expression");d.push("("+p+" ? "+h+" : "+f+")")}else if(g===i)d.push(m.value);else if(g===e)p=d.pop(),"-"===(v=m.value)||"+"===v?d.push("("+v+p+")"):c?"not"===v?d.push("(!"+p+")"):"!"===v?d.push("fac("+p+")"):d.push(v+"("+p+")"):"!"===v?d.push("("+p+"!)"):d.push("("+v+" "+p+")");else if(g===s){for(var b=m.value,x=[];b-- >0;)x.unshift(d.pop());v=d.pop(),d.push(v+"("+x.join(", ")+")")}else if(g===a)p=d.pop(),d.push(p+"."+m.value);else{if(g!==o)throw new Error("invalid Expression");d.push("("+l(m.value,c)+")")}}var w;if(d.length>1)throw new Error("invalid Expression (parity)");return String(d[0])}function f(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function v(t,e,n){for(var r=!!(n=n||{}).withMembers,s=null,u=0;u<t.length;u++){var c=t[u];c.type!==i||f(e,c.value)?c.type===a&&r&&null!==s?s+="."+c.value:c.type===o?v(c.value,e,n):null!==s&&(f(e,s)||e.push(s),s=null):r?null!==s?(f(e,s)||e.push(s),s=c.value):s=c.value:e.push(c.value)}null===s||f(e,s)||e.push(s)}function d(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}u.prototype.toString=function(){switch(this.type){case t:case e:case n:case r:case i:return this.value;case s:return"CALL "+this.value;case a:return"."+this.value;default:return"Invalid Instruction"}},d.prototype.simplify=function(s){return s=s||{},new d(function s(c,p,h,l,f){for(var v,d,y,m,g=[],b=[],x=0;x<c.length;x++){var w=c[x],M=w.type;if(M===t)g.push(w);else if(M===i&&f.hasOwnProperty(w.value))w=new u(t,f[w.value]),g.push(w);else if(M===n&&g.length>1)d=g.pop(),v=g.pop(),m=h[w.value],w=new u(t,m(v.value,d.value)),g.push(w);else if(M===r&&g.length>2)y=g.pop(),d=g.pop(),v=g.pop(),"?"===w.value?g.push(v.value?d.value:y.value):(m=l[w.value],w=new u(t,m(v.value,d.value,y.value)),g.push(w));else if(M===e&&g.length>0)v=g.pop(),m=p[w.value],w=new u(t,m(v.value)),g.push(w);else if(M===o){for(;g.length>0;)b.push(g.shift());b.push(new u(o,s(w.value,p,h,l,f)))}else if(M===a&&g.length>0)v=g.pop(),g.push(new u(t,v.value[w.value]));else{for(;g.length>0;)b.push(g.shift());b.push(w)}}for(;g.length>0;)b.push(g.shift());return b}(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,s),this.parser)},d.prototype.substitute=function(t,s){return s instanceof d||(s=this.parser.parse(String(s))),new d(function t(s,a,l){for(var f=[],v=0;v<s.length;v++){var d=s[v],y=d.type;if(y===i&&d.value===a)for(var m=0;m<l.tokens.length;m++){var g,b=l.tokens[m];g=b.type===e?c(b.value):b.type===n?p(b.value):b.type===r?h(b.value):new u(b.type,b.value),f.push(g)}else y===o?f.push(new u(o,t(d.value,a,l))):f.push(d)}return f}(this.tokens,t,s),this.parser)},d.prototype.evaluate=function(u){return u=u||{},function u(c,p,h){for(var l,f,v,d,y=[],m=0;m<c.length;m++){var g=c[m],b=g.type;if(b===t)y.push(g.value);else if(b===n)f=y.pop(),l=y.pop(),"and"===g.value?y.push(!!l&&!!u(f,p,h)):"or"===g.value?y.push(!!l||!!u(f,p,h)):(d=p.binaryOps[g.value],y.push(d(l,f)));else if(b===r)v=y.pop(),f=y.pop(),l=y.pop(),"?"===g.value?y.push(u(l?f:v,p,h)):(d=p.ternaryOps[g.value],y.push(d(l,f,v)));else if(b===i)if(g.value in p.functions)y.push(p.functions[g.value]);else{var x=h[g.value];if(void 0===x)throw new Error("undefined variable: "+g.value);y.push(x)}else if(b===e)l=y.pop(),d=p.unaryOps[g.value],y.push(d(l));else if(b===s){for(var w=g.value,M=[];w-- >0;)M.unshift(y.pop());if(!(d=y.pop()).apply||!d.call)throw new Error(d+" is not a function");y.push(d.apply(void 0,M))}else if(b===o)y.push(g.value);else{if(b!==a)throw new Error("invalid Expression");l=y.pop(),y.push(l[g.value])}}if(y.length>1)throw new Error("invalid Expression (parity)");return y[0]}(this.tokens,this,u)},d.prototype.toString=function(){return l(this.tokens,!1)},d.prototype.symbols=function(t){t=t||{};var e=[];return v(this.tokens,e,t),e},d.prototype.variables=function(t){t=t||{};var e=[];v(this.tokens,e,t);var n=this.functions;return e.filter(function(t){return!(t in n)})},d.prototype.toJSFunction=function(t,e){var n=this,r=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+l(this.simplify(e).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var y="TOP";function m(t,e,n){this.type=t,this.value=e,this.index=n}function g(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options}m.prototype.toString=function(){return this.type+": "+this.value},g.prototype.newToken=function(t,e,n){return new m(t,e,null!=n?n:this.pos)},g.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},g.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},g.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},g.prototype.isString=function(){var t=!1,e=this.pos,n=this.expression.charAt(e);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,e+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var i=this.expression.substring(e+1,r);this.current=this.newToken("TSTRING",this.unescape(i),e),t=!0;break}r=this.expression.indexOf(n,r+1)}return t},g.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken("TPAREN",t),this.pos++,!0)},g.prototype.isComma=function(){var t=this.expression.charAt(this.pos);return","===t&&(this.current=this.newToken("TCOMMA",","),this.pos++,!0)},g.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken("TNUMBER",this.consts[r]),this.pos+=r.length,!0}return!1},g.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(y,r),this.pos+=r.length,!0}return!1},g.prototype.isName=function(){for(var t=this.pos,e=t,n=!1;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()){if(e===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(e===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var i=this.expression.substring(t,e);return this.current=this.newToken("TNAME",i),this.pos+=i.length,!0}return!1},g.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var b=/^[0-9a-f]{4}$/i;g.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var i=t.substring(e+1,e+5);b.test(i)||this.parseError("Illegal escape sequence: \\u"+i),n+=String.fromCharCode(parseInt(i,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var s=t.indexOf("\\",e);n+=t.substring(e,s<0?t.length:s),e=s}return n},g.prototype.isComment=function(){var t=this.expression.charAt(this.pos);return"/"===t&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},g.prototype.isRadixInteger=function(){var t,e,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))t=16,e=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;t=2,e=/^[01]$/i,++n}for(var r=!1,i=n;n<this.expression.length;){var s=this.expression.charAt(n);if(!e.test(s))break;n++,r=!0}return r&&(this.current=this.newToken("TNUMBER",parseInt(this.expression.substring(i,n),t)),this.pos=n),r},g.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,i=n,s=!1,o=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!s&&"."===t);)"."===t?s=!0:o=!0,n++,e=o;if(e&&(i=n),"e"===t||"E"===t){n++;for(var a=!0,u=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!a||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;u=!0,a=!1}else a=!1;n++}u||(n=i)}return e?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=i,e},g.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(y,e);else if("∙"===e||"•"===e)this.current=this.newToken(y,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(y,">="),this.pos++):this.current=this.newToken(y,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(y,"<="),this.pos++):this.current=this.newToken(y,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(y,"||"),this.pos++}else if("="===e){if("="!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(y,"=="),this.pos++}else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(y,"!="),this.pos++):this.current=this.newToken(y,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)};var x={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional"};function w(t,e,n){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}g.prototype.isOperatorEnabled=function(t){var e=function(t){return x.hasOwnProperty(t)?x[t]:t}(t),n=this.options.operators||{};return"in"===e?!!n.in:!(e in n&&!n[e])},g.prototype.getCoordinates=function(){var t,e=0,n=-1;do{e++,t=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:e,column:t}},g.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},w.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},w.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?f(e,t.value):"function"==typeof e?e(t):t.value===e)},w.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},w.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},w.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e)||(this.next(),0))},w.prototype.expect=function(t,e){if(!this.accept(t,e)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(e||t))}},w.prototype.parseAtom=function(e){if(this.accept("TNAME"))e.push(new u(i,this.current.value));else if(this.accept("TNUMBER"))e.push(new u(t,this.current.value));else if(this.accept("TSTRING"))e.push(new u(t,this.current.value));else{if(!this.accept("TPAREN","("))throw new Error("unexpected "+this.nextToken);this.parseExpression(e),this.expect("TPAREN",")")}},w.prototype.parseExpression=function(t){this.parseConditionalExpression(t)},w.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(y,"?");){var e=[],n=[];this.parseConditionalExpression(e),this.expect(y,":"),this.parseConditionalExpression(n),t.push(new u(o,e)),t.push(new u(o,n)),t.push(h("?"))}},w.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(y,"or");){var e=[];this.parseAndExpression(e),t.push(new u(o,e)),t.push(p("or"))}},w.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(y,"and");){var e=[];this.parseComparison(e),t.push(new u(o,e)),t.push(p("and"))}};var M=["==","!=","<","<=",">=",">","in"];w.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(y,M);){var e=this.current;this.parseAddSub(t),t.push(p(e.value))}};var k=["+","-","||"];w.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(y,k);){var e=this.current;this.parseTerm(t),t.push(p(e.value))}};var O=["*","/","%"];function E(t,e){return Number(t)+Number(e)}function _(t,e){return t-e}function T(t,e){return t*e}function C(t,e){return t/e}function A(t,e){return t%e}function P(t,e){return""+t+e}function N(t,e){return t===e}function S(t,e){return t!==e}function j(t,e){return t>e}function I(t,e){return t<e}function q(t,e){return t>=e}function R(t,e){return t<=e}function F(t,e){return Boolean(t&&e)}function D(t,e){return Boolean(t||e)}function Q(t,e){return f(e,t)}function L(t){return(Math.exp(t)-Math.exp(-t))/2}function U(t){return(Math.exp(t)+Math.exp(-t))/2}function V(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function B(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function G(t){return Math.log(t+Math.sqrt(t*t-1))}function $(t){return Math.log((1+t)/(1-t))/2}function J(t){return Math.log(t)*Math.LOG10E}function W(t){return-t}function z(t){return!t}function X(t){return t<0?Math.ceil(t):Math.floor(t)}function H(t){return Math.random()*(t||1)}function K(t){return tt(t+1)}w.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(y,O);){var e=this.current;this.parseFactor(t),t.push(p(e.value))}},w.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(y,function(t){return t.value in e}))if("-"!==this.current.value&&"+"!==this.current.value&&"TPAREN"===this.nextToken.type&&"("===this.nextToken.value)this.restore(),this.parseExponential(t);else{var n=this.current;this.parseFactor(t),t.push(c(n.value))}else this.parseExponential(t)},w.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(y,"^");)this.parseFactor(t),t.push(p("^"))},w.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(y,"!");)t.push(c("!"))},w.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(y,function(t){return t.value in e})){var n=this.current;this.parseAtom(t),t.push(c(n.value))}else for(this.parseMemberExpression(t);this.accept("TPAREN","(");)if(this.accept("TPAREN",")"))t.push(new u(s,0));else{var r=this.parseArgumentList(t);t.push(new u(s,r))}},w.prototype.parseArgumentList=function(t){for(var e=0;!this.accept("TPAREN",")");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},w.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(y,".");){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect("TNAME"),t.push(new u(a,this.current.value))}};var Y=4.7421875,Z=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function tt(t){var e,n;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,i=t-1;r>1;)i*=r,r--;return 0===i&&(i=1),i}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*tt(1-t));if(t>=171.35)return 1/0;if(t>85){var s=t*t,o=s*t,a=o*t,u=a*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*s)-139/(51840*o)-571/(2488320*a)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,n=Z[0];for(var c=1;c<Z.length;++c)n+=Z[c]/(t+c);return e=t+Y+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n}function et(t){return String(t).length}function nt(){for(var t=0,e=0,n=0;n<arguments.length;n++){var r,i=Math.abs(arguments[n]);e<i?(t=t*(r=e/i)*r+1,e=i):t+=i>0?(r=i/e)*r:i}return e===1/0?1/0:e*Math.sqrt(t)}function rt(t,e,n){return t?e:n}function it(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function st(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||L,cosh:Math.cosh||U,tanh:Math.tanh||V,asinh:Math.asinh||B,acosh:Math.acosh||G,atanh:Math.atanh||$,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||J,log10:Math.log10||J,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||X,"-":W,"+":Number,exp:Math.exp,not:z,length:et,"!":K},this.binaryOps={"+":E,"-":_,"*":T,"/":C,"%":A,"^":Math.pow,"||":P,"==":N,"!=":S,">":j,"<":I,">=":q,"<=":R,and:F,or:D,in:Q},this.ternaryOps={"?":rt},this.functions={random:H,fac:K,min:Math.min,max:Math.max,hypot:Math.hypot||nt,pyt:Math.hypot||nt,pow:Math.pow,atan2:Math.atan2,if:rt,gamma:tt,roundTo:it},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}st.prototype.parse=function(t){var e=[],n=new w(this,new g(this,t),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(e),n.expect("TEOF","EOF"),new d(e,this)},st.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var ot=new st;return st.parse=function(t){return ot.parse(t)},st.evaluate=function(t,e){return ot.parse(t).evaluate(e)},{Parser:st,Expression:d}}()},135:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(37),s=n(136),o=(r=s)&&r.__esModule?r:{default:r};var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{u(r.next(t))}catch(t){s(t)}}function a(t){try{u(r.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,a)}u((r=r.apply(t,e||[])).next())})},c=function(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},p=1e3,h=function(t){return{url:t.split("::")[0],container:t.split("::")[1]||null}},l=function(){function t(t){this.backendSrv=t,this.transformations=new o.default,this.metricInfo=null,this.metricNames=[],this.contexts={},this.required=[],this.collected=[],setInterval(this.doPollAll.bind(this),p)}return t.prototype.doPollAll=function(){var t=this,e=(new Date).getTime()-2e4;this.required=this.required.filter(function(t){return t.lastRequested>e});for(var n=(0,i.groupBy)(this.required,"endpoint"),r=(0,i.objectMap)(n,function(t){return t.map(function(t){return t.metric})}),s=[],o=0,a=Object.keys(r);o<a.length;o++){var u=a[o];s.push(this.doPollOne(u,r[u]))}Promise.all(s).then(function(){for(var e=(new Date).getTime()-3e5,n=0,r=t.collected;n<r.length;n++){var i=r[n];i.datas=i.datas.filter(function(t){return t[0]>e})}})},t.prototype.getContext=function(t,e){return u(this,void 0,void 0,function(){var e,n,r,i,s,o,a,u,p;return c(this,function(c){switch(c.label){case 0:return e=h(t),n=e.url,r=e.container,i=n+"/pmapi/context?hostspec=127.0.0.1&polltimeout=30",r&&(i+="&container="+r),[4,this.backendSrv.datasourceRequest({url:i})];case 1:return s=c.sent(),o=s.data.context,r?[4,this.backendSrv.datasourceRequest({url:n+"/pmapi/"+o+"/_store?name=pmcd.client.container&value="+r})]:[3,3];case 2:c.sent(),c.label=3;case 3:return[4,this.backendSrv.datasourceRequest({url:n+"/pmapi/"+o+"/_metric"})];case 4:return a=c.sent(),u=a.data.metrics.map(function(t){return{name:t.name,pmid:t.pmid}}),this.metricInfo?[3,6]:[4,this.backendSrv.datasourceRequest({url:n+"/pmapi/"+o+"/_metric"})];case 5:p=c.sent(),this.metricInfo=p.data.metrics,this.metricNames=this.metricInfo.map(function(t){return t.name}),this.metricNames.sort(),this.transformations.init(this.metricInfo),c.label=6;case 6:return[2,{context:o,pmids:u,indoms:{},missingMetrics:[]}]}})})},t.prototype.ensureContext=function(t,e){return!e&&t in this.contexts?this.contexts[t]:(this.contexts[t]=this.getContext(t,e),this.contexts[t].catch(function(t){return console.log("error acquiring context",t),!1}))},t.prototype.getMetrics=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,s,o=this;return c(this,function(a){switch(a.label){case 0:return n=h(t).url,[4,this.ensureContext(t,!1)];case 1:if(!(r=a.sent()))return[2];if(!(i=e.map(function(t){return o.lookupPmidForMetric(r,t)}).filter(function(t){return!!t})).length)return[2];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.backendSrv.datasourceRequest({url:n+"/pmapi/"+r.context+"/_fetch?pmids="+i.join(",")})];case 3:return[2,a.sent()];case 4:return s=a.sent(),console.log("err fetching pmids",s),this.ensureContext(t,!0),[2];case 5:return[2]}})})},t.prototype.doPollOne=function(t,e){return u(this,void 0,void 0,function(){var n;return c(this,function(r){switch(r.label){case 0:return[4,this.getMetrics(t,e)];case 1:return n=r.sent(),[4,this.appendFetchResultDataToCollection(t,n.data)];case 2:return r.sent(),[2]}})})},t.prototype.appendFetchResultDataToCollection=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,s,o,a;return c(this,function(u){switch(u.label){case 0:n=1e3*e.timestamp.s+e.timestamp.us/1e3,r=function(e){var r,s,o;return c(this,function(a){switch(a.label){case 0:return s=[n],[4,i.renameIndoms(t,e.name,e.instances)];case 1:return r=s.concat([a.sent()]),(o=i.collected.find(function(n){return n.endpoint===t&&n.metric===e.name}))?o.datas.push(r):i.collected.push({endpoint:t,metric:e.name,datas:[r]}),[2]}})},i=this,s=0,o=e.values,u.label=1;case 1:return s<o.length?(a=o[s],[5,r(a)]):[3,4];case 2:u.sent(),u.label=3;case 3:return s++,[3,1];case 4:return[2]}})})},t.prototype.renameIndoms=function(t,e,n){return u(this,void 0,void 0,function(){var r,i,s,o,u,p,h;return c(this,function(c){switch(c.label){case 0:return r=!1,[4,this.ensureContext(t,!1)];case 1:for(i=c.sent(),s=[],o=function(t){if(-1===t.instance)s.push(t);else{var n=(i.indoms[e]||[]).find(function(e){return e.instance===t.instance});s.push(a({},t,{instanceName:n?n.name:t.instance})),n||(r=!0)}},u=0,p=n;u<p.length;u++)h=p[u],o(h);return r&&this.refreshIndoms(t,e),[2,s]}})})},t.prototype.refreshIndoms=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,s;return c(this,function(o){switch(o.label){case 0:return n=h(t).url,[4,this.ensureContext(t,!1)];case 1:if(!(r=o.sent()))return[2];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.backendSrv.datasourceRequest({url:n+"/pmapi/"+r.context+"/_indom?name="+e})];case 3:return i=o.sent(),[3,5];case 4:return s=o.sent(),console.log("err fetching indoms",s),[2];case 5:return r.indoms[e]=i.data.instances,[2]}})})},t.prototype.lookupPmidForMetric=function(t,e){var n=t.pmids.find(function(t){return t.name===e});return n?n.pmid:(t.missingMetrics.includes(e)||(t.missingMetrics.push(e),console.log("is pmda enabled? missing pmid for:",e)),null)},t.prototype.ensurePolling=function(t,e){for(var n=(new Date).getTime(),r=function(e){var r=i.required.find(function(n){return n.endpoint===t&&n.metric===e});r?r.lastRequested=n:i.required.push({endpoint:t,metric:e,lastRequested:n})},i=this,s=0,o=e;s<o.length;s++){r(o[s])}},t.prototype.collectData=function(t,e){var n=this.collected.filter(function(n){return n.endpoint===t&&e.includes(n.metric)});return this.transformations.applyTransforms(n)},t}();e.default=l},136:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},i=function(){function t(){this.transforms={}}return t.prototype.init=function(t){var e=this;t.forEach(function(t){return e.transforms[t.name]=[]}),t.filter(function(t){return"counter"===t.sem}).forEach(function(t){return e.transforms[t.name].push(e.unaccumulate)})},t.prototype.applyTransforms=function(t){var e=this;return t.map(function(t){var n=e.transforms[t.metric]||[],r=t.datas;return n.forEach(function(t){return r=t(r)}),{endpoint:t.endpoint,metric:t.metric,datas:r}})},t.prototype.unaccumulate=function(t){t=t.sort(function(t,e){return t[0]-e[0]});for(var e=[],n=function(n){var i=t[n-1][0],s=t[n-1][1],o=t[n][0],a=t[n][1],u=(o-i)/1e3,c=a.map(function(t){var e=s.find(function(e){return e.instance===t.instance});return e?r({},t,{value:(t.value-e.value)/u}):null}).filter(function(t){return!!t});e.push([t[n][0],c])},i=1;i<t.length;i++)n(i);return e},t}();e.default=i},137:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cleanTitusOvfsLatencyCollected=i,e.transformAfterCollected=function(t,e){return t.map(function(t){return function(t,e){if(!["titustc.network.out.requeues_packets","titustc.network.out.overlimits_packets","titustc.network.out.dropped_packets","titustc.network.out.packets","titustc.network.out.bytes","titustc.network.out.ceiling","titustc.network.out.rate","titustc.network.in.requeues_packets","titustc.network.in.overlimits_packets","titustc.network.in.dropped_packets","titustc.network.in.packets","titustc.network.in.bytes","titustc.network.in.ceiling","titustc.network.in.rate"].includes(t.metric))return t;var n=function(t){return e&&"string"==typeof t.instanceName&&t.instanceName.includes(e)};return{endpoint:t.endpoint,metric:t.metric,datas:t.datas.map(function(t){return[t[0],t[1].filter(n)]}).filter(function(t){return t[1].length>0})}}(t,e)}).map(function(t){return function(t,e){if(!["titusovfs.read.bytes_per_sec","titusovfs.write.bytes_per_sec"].includes(t.metric)||!e)return t;var n=function(t){return e&&"string"==typeof t.instanceName&&t.instanceName.includes(e)};return{endpoint:t.endpoint,metric:t.metric,datas:t.datas.map(function(t){return[t[0],t[1].filter(n)]}).filter(function(t){return t[1].length>0})}}(t,e)}).map(function(t){return i(t,e)}).filter(function(t){return t.datas.length>0})};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t,e){if(!["titusovfs.read.latency","titusovfs.write.latency","titusovfs.open.latency","titusovfs.fsync.latency"].includes(t.metric)||!e)return t;var n=function(t){return"string"==typeof t.instanceName},i=function(t){return t[1].length>0},s=function(t){return 2===t.instanceName.split(":").length&&t.instanceName.split(":")[0].includes(e)},o=function(t){return r({},t,{instanceName:t.instanceName.split(":")[1].split("-")[1]})};return{endpoint:t.endpoint,metric:t.metric,datas:t.datas.map(function(t){return[t[0],t[1].filter(n)]}).filter(i).map(function(t){return[t[0],t[1].filter(s)]}).filter(i).map(function(t){return[t[0],t[1].map(o)]})}}},138:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GenericDatasourceQueryCtrl=void 0;var r,i=n(19),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scope=e,r.target.target=r.target.target||"select metric",r.target.displayName=r.target.displayName||r.target.target,r.target.type=r.target.type||"timeserie",r}return s(e,t),e.prototype.getOptions=function(t){return this.datasource.metricFindQuery(t||"")},e.prototype.toggleEditorMode=function(){this.target.rawQuery=!this.target.rawQuery},e.prototype.onChangeInternal=function(){this.panelCtrl.refresh()},e.templateUrl="datasources/live/partials/query.editor.html",e}(i.QueryCtrl);e.GenericDatasourceQueryCtrl=o},19:function(e,n){e.exports=t},37:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.groupBy=function(t,e){return t.reduce(function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t},{})},e.objectMap=function(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=e(t[r]),n},{})},e.sharedPrefixLength=function(t){for(var e=t.concat().sort(),n=e[0],r=e[e.length-1],i=n.length,s=0;s<i&&n.charAt(s)===r.charAt(s);)s++;return s},e.flatMap=function(t,e){return e.reduce(function(e,n){return e.concat(t(n))},[])},e.expandDottedStringToObject=function(t,e){for(var n=t.split("."),r={},i=r,s=0;s<n.length-1;s++)i[n[s]]={},i=i[n[s]];return i[n[n.length-1]]=e,r}}})});
//# sourceMappingURL=module.js.map