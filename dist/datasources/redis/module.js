define(["lodash","app/plugins/sdk"],function(t,e){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=94)}([function(e,r){e.exports=t},function(t,e,r){"use strict";var n;r.d(e,"a",function(){return n}),function(t){t.TimeSeries="time_series",t.MetricsTable="metrics_table",t.CsvTable="csv_table",t.Heatmap="heatmap",t.FlameGraph="flamegraph"}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"c",function(){return o}),r.d(e,"b",function(){return a}),r.d(e,"a",function(){return u}),r.d(e,"d",function(){return s});var n=r(0),i=r.n(n);function o(t,e,r){var n=r.value;r.value=function(){var t=this;return this.inflightCalls||(this.inflightCalls={}),this.inflightCalls[e]?this.inflightCalls[e]:(this.inflightCalls[e]=n.apply(this,arguments),this.inflightCalls[e].then(function(r){return t.inflightCalls[e]=null,r},function(r){throw t.inflightCalls[e]=null,r}))}}function a(t){return!(t&&i.a.isString(t)&&t.trim().length>0)}function u(t){var e={};return t.variables?(t.variables.forEach(function(t){var r=t.current.value;("$__all"===r||i.a.isEqual(r,["$__all"]))&&(r=null===t.allValue?t.options.slice(1).map(function(t){return t.value}):t.allValue),e[t.name]={text:t.current.text,value:r}}),e):{}}function s(t,e){for(var r=t.split(".").map(function(t){return parseInt(t,10)}),n=e.split(".").map(function(t){return parseInt(t,10)}),i=Math.min(r.length,n.length),o=0;o<i;o++){if(r[o]>n[o])return 1;if(r[o]<n[o])return-1}return r.length===n.length?0:r.length<n.length?-1:1}},,function(t,e,r){(function(e){var r="object",n=function(t){return t&&t.Math==Math&&t};t.exports=n(typeof globalThis==r&&globalThis)||n(typeof window==r&&window)||n(typeof self==r&&self)||n(typeof e==r&&e)||Function("return this")()}).call(this,r(56))},,function(t,e,r){var n=r(7);t.exports=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(6),i=r(15),o=r(23);t.exports=n?function(t,e,r){return i.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e,r){var n=r(8);t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,r){var n=r(4),i=r(16),o=r(60),a=n["__core-js_shared__"]||i("__core-js_shared__",{});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.1.3",mode:o?"pure":"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var n=r(19),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e,r){var n=r(58),i=r(25);t.exports=function(t){return n(i(t))}},function(t,e,r){var n=r(6),i=r(27),o=r(11),a=r(26),u=Object.defineProperty;e.f=n?u:function(t,e,r){if(o(t),e=a(e,!0),o(r),i)try{return u(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(4),i=r(10);t.exports=function(t,e){try{i(n,t,e)}catch(r){n[t]=e}return e}},function(t,e){t.exports={}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},,,function(t,e,r){var n=r(6),i=r(57),o=r(23),a=r(14),u=r(26),s=r(9),c=r(27),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=a(t),e=u(e,!0),c)try{return l(t,e)}catch(t){}if(s(t,e))return o(!i.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,r){var n=r(8);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(6),i=r(7),o=r(28);t.exports=!n&&!i(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(4),i=r(8),o=n.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},function(t,e,r){var n=r(12);t.exports=n("native-function-to-string",Function.toString)},function(t,e,r){var n=r(12),i=r(31),o=n("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++r+n).toString(36)}},function(t,e,r){var n=r(65),i=r(4),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(n[t])||o(i[t]):n[t]&&n[t][e]||i[t]&&i[t][e]}},function(t,e,r){var n=r(9),i=r(14),o=r(67).indexOf,a=r(17);t.exports=function(t,e){var r,u=i(t),s=0,c=[];for(r in u)!n(a,r)&&n(u,r)&&c.push(r);for(;e.length>s;)n(u,r=e[s++])&&(~o(c,r)||c.push(r));return c}},function(t,e,r){var n=r(24);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(36);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,r){var n=r(4),i=r(12),o=r(31),a=r(71),u=n.Symbol,s=i("wks");t.exports=function(t){return s[t]||(s[t]=a&&u[t]||(a?u:o)("Symbol."+t))}},function(t,e,r){"use strict";var n=r(0),i=r.n(n),o=r(2),a=r(1),u=(r(44),function(){return(u=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)}),s=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},l=function(){function t(t){this.templateSrv=t}return t.prototype.getLabel=function(t,e,r,n,a,s){if(void 0===s&&(s={}),Object(o.b)(e.legendFormat))return r(n,a,s);s=i.a.mapValues(s,function(t){return{value:t}});var c=n.split("."),l=u({},t.scopedVars,s,{metric:{value:n},metric0:{value:c[c.length-1]}});return a&&""!==a.name&&(l.instance={value:a.name}),this.templateSrv.replace(e.legendFormat,l)},t.prototype.transformToTimeSeries=function(t,e,r,n){var i=this;return n.instances.map(function(o){return{target:i.getLabel(t,e,r,n.name,o,o.labels),datapoints:o.values}})},t.prototype.transformToHeatmap=function(t){return t.instances.map(function(t){var e=t.name,r=t.name.match(/^(.+?)\-(.+?)$/);return r&&(e=r[2]),{target:e,datapoints:t.values.map(function(t){return[t[0],1e3*Math.floor(t[1]/1e3)]})}})},t.prototype.parseCsvLine=function(t){var e,r,n,i,o,a,u,l;return s(this,function(s){switch(s.label){case 0:e="",r="",s.label=1;case 1:s.trys.push([1,10,11,12]),n=c(t),i=n.next(),s.label=2;case 2:return i.done?[3,9]:(o=i.value,0!==e.length?[3,7]:'"'!==o&&"'"!==o?[3,3]:(e=o,[3,6]));case 3:return","!==o?[3,5]:[4,r];case 4:return s.sent(),r="",[3,6];case 5:r+=o,s.label=6;case 6:return[3,8];case 7:o===e?e="":r+=o,s.label=8;case 8:return i=n.next(),[3,2];case 9:return[3,12];case 10:return a=s.sent(),u={error:a},[3,12];case 11:try{i&&!i.done&&(l=n.return)&&l.call(n)}finally{if(u)throw u.error}return[7];case 12:return r.length>0?[4,r]:[3,14];case 13:s.sent(),s.label=14;case 14:return[2]}})},t.prototype.transformCsvToTable=function(t){var e,r,n={columns:[],rows:[],type:"table"},o="";if(1===t.length&&1===t[0].metrics.length&&1===t[0].metrics[0].instances.length&&t[0].metrics[0].instances[0].values.length>0){var a=t[0].metrics[0].instances[0],u=a.values[a.values.length-1][0];i.a.isString(u)&&u.includes(",")&&(o=u)}var s=o.split("\n");try{for(var l=c(s),f=l.next();!f.done;f=l.next()){var p=f.value;if(0!==(p=p.trim()).length)if(0===n.columns.length){var h=Array.from(this.parseCsvLine(p));n.columns=h.map(function(t){return{text:t}})}else{var v=Array.from(this.parseCsvLine(p));n.rows.push(v)}}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return n},t.prototype.transformMetricsToTable=function(t,e,r){var n,o,a=this,u={columns:[],rows:[],type:"table"};u.columns=e.flatMap(function(e){return e.metrics.map(function(n){return{text:a.getLabel(t,e.target,r,n.name)}})}),u.columns.unshift({text:"instance"});var s=i.a.uniq(e.flatMap(function(t){return t.metrics.flatMap(function(t){return t.instances.map(function(t){return t.name})})})),l=function(t){var r,n,i,o,a=[t];try{for(var s=(r=void 0,c(e)),l=s.next();!l.done;l=s.next()){var f=l.value;try{for(var p=(i=void 0,c(f.metrics)),h=p.next();!h.done;h=p.next()){var v=h.value.instances.find(function(e){return e.name===t});v&&v.values.length>0?a.push(v.values[v.values.length-1][0]):a.push("")}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}u.rows.push(a)};try{for(var f=c(s),p=f.next();!p.done;p=f.next()){l(p.value)}}catch(t){n={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}return u},t.prototype.transformToFlameGraph=function(t){return t.instances.map(function(t){return{target:t.name,datapoints:t.values}})},t.prototype.transform=function(t,e,r){var n=this,i=e[0].target.format;if(i===a.a.TimeSeries)return e.flatMap(function(e){return e.metrics.flatMap(function(i){return n.transformToTimeSeries(t,e.target,r,i)})});if(i===a.a.Heatmap)return e.flatMap(function(t){return t.metrics.flatMap(function(t){return n.transformToHeatmap(t)})});if(i===a.a.MetricsTable)return[this.transformMetricsToTable(t,e,r)];if(i===a.a.CsvTable)return[this.transformCsvToTable(e)];if(i===a.a.FlameGraph)return e.flatMap(function(t){return t.metrics.flatMap(function(t){return n.transformToFlameGraph(t)})});throw{message:"Invalid target format '"+i+"'."}},t}();e.a=l},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(0),i=r.n(n),o=r(1),a=function(){function t(){}return t.applyTransformations=function(e,r,n,a){var u=[];if("counter"===r){var s=e===o.a.FlameGraph;u.push(t.counter(s)),n in this.PCP_UNITS&&u.push(t.divideBy(this.PCP_UNITS[n]))}var c=i.a.cloneDeep(a);return c.sort(function(t,e){return t[1]-e[1]}),u.reduce(function(t,e){return e(t)},c)},t.counter=function(t){return void 0===t&&(t=!1),function(e){if(0===e.length)return e;for(var r=e[0],n=1;n<e.length;){var i=e[n].slice();if(i[0]>=r[0]){var o=(i[1]-r[1])/1e3;e[n][0]=t?Math.ceil((i[0]-r[0])/o):(i[0]-r[0])/o,n++}else e.splice(n,1);r=i}return e.shift(),e}},t.divideBy=function(t){return function(e){return e.forEach(function(e){e[0]/=t}),e}},t.PCP_UNITS={nanosec:1e9,microsec:1e6,millisec:1e3},t}()},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n,i=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=function(t){function e(r){var n=this,i="Network error";return r.err?i="Network error: Could not connect to "+r.err.config.url+", please check the datasource and pmproxy settings":r.statusText&&(i="HTTP Error "+r.status+": "+r.statusText+", please check the datasource and pmproxy settings"),(n=t.call(this,i)||this).data=r.data,Object.setPrototypeOf(n,e.prototype),n}return i(e,t),e}(Error)},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var n,i=r(0),o=r.n(i),a=r(42),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},c=function(t){function e(e,r,n){void 0===n&&(n=1e3);var i=t.call(this,e,r)||this;return i.typingDebounceTime=n,i.stopTypingDebounced=o.a.debounce(i.stopTyping,i.typingDebounceTime),i}return u(e,t),e.prototype.stopTyping=function(){delete this.target.isTyping},e.prototype.startTyping=function(){this.target.isTyping=!0,this.stopTypingDebounced()},e.prototype.targetChanged=function(){this.stopTyping(),this.panelCtrl.refresh()},e.prototype.tryRemoveTextCompleter=function(t){var e,r;if(!ace)return!1;var n=ace.acequire("ace/ext/language_tools").textCompleter;if(!n)return!1;var i=!1;try{for(var o=s(Array.from(document.querySelectorAll("code-editor[data-mode="+t+"]"))),a=o.next();!a.done;a=o.next()){var u=a.value;if(u.env){var c=Array.from(u.env.editor.completers),l=c.indexOf(n);l>=0&&(c.splice(l,1),u.env.editor.completers=c),i=!0}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return i},e.prototype.removeTextCompleter=function(t){this.tryRemoveTextCompleter(t)||setTimeout(this.tryRemoveTextCompleter.bind(this,t),2e3)},e}(a.QueryCtrl)},function(t,r){t.exports=e},,function(t,e,r){t.exports=r(54)},function(t,e,r){var n=r(4),i=r(22).f,o=r(10),a=r(59),u=r(16),s=r(63),c=r(70);t.exports=function(t,e){var r,l,f,p,h,v=t.target,y=t.global,d=t.stat;if(r=y?n:d?n[v]||u(v,{}):(n[v]||{}).prototype)for(l in e){if(p=e[l],f=t.noTargetGet?(h=i(r,l))&&h.value:r[l],!c(y?l:v+(d?".":"#")+l,t.forced)&&void 0!==f){if(typeof p==typeof f)continue;s(p,f)}(t.sham||f&&f.sham)&&o(p,"sham",!0),a(r,l,p,t)}}},function(t,e,r){"use strict";var n=r(34),i=r(13),o=r(35),a=function(t,e,r,u,s,c,l,f){for(var p,h=s,v=0,y=!!l&&o(l,f,3);v<u;){if(v in r){if(p=y?y(r[v],v,e):r[v],c>0&&n(p))h=a(t,e,p,i(p.length),h,c-1)-1;else{if(h>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[h]=p}h++}v++}return h};t.exports=a},function(t,e,r){var n=r(25);t.exports=function(t){return Object(n(t))}},function(t,e,r){var n=r(8),i=r(34),o=r(37)("species");t.exports=function(t,e){var r;return i(t)&&("function"!=typeof(r=t.constructor)||r!==Array&&!i(r.prototype)?n(r)&&null===(r=r[o])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===e?0:e)}},function(t,e,r){var n=r(37),i=r(73),o=r(10),a=n("unscopables"),u=Array.prototype;null==u[a]&&o(u,a,i(null)),t.exports=function(t){u[a][t]=!0}},function(t,e,r){var n=r(4),i=r(35),o=Function.call;t.exports=function(t,e,r){return i(o,n[t].prototype[e],r)}},,,,function(t,e,r){r(55),r(72);var n=r(50);t.exports=n("Array","flatMap")},function(t,e,r){"use strict";var n=r(45),i=r(46),o=r(47),a=r(13),u=r(36),s=r(48);n({target:"Array",proto:!0},{flatMap:function(t){var e,r=o(this),n=a(r.length);return u(t),(e=s(r,0)).length=i(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}})},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!n.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:n},function(t,e,r){var n=r(7),i=r(24),o="".split;t.exports=n(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},function(t,e,r){var n=r(4),i=r(12),o=r(10),a=r(9),u=r(16),s=r(29),c=r(61),l=c.get,f=c.enforce,p=String(s).split("toString");i("inspectSource",function(t){return s.call(t)}),(t.exports=function(t,e,r,i){var s=!!i&&!!i.unsafe,c=!!i&&!!i.enumerable,l=!!i&&!!i.noTargetGet;"function"==typeof r&&("string"!=typeof e||a(r,"name")||o(r,"name",e),f(r).source=p.join("string"==typeof e?e:"")),t!==n?(s?!l&&t[e]&&(c=!0):delete t[e],c?t[e]=r:o(t,e,r)):c?t[e]=r:u(e,r)})(Function.prototype,"toString",function(){return"function"==typeof this&&l(this).source||s.call(this)})},function(t,e){t.exports=!1},function(t,e,r){var n,i,o,a=r(62),u=r(4),s=r(8),c=r(10),l=r(9),f=r(30),p=r(17),h=u.WeakMap;if(a){var v=new h,y=v.get,d=v.has,m=v.set;n=function(t,e){return m.call(v,t,e),e},i=function(t){return y.call(v,t)||{}},o=function(t){return d.call(v,t)}}else{var g=f("state");p[g]=!0,n=function(t,e){return c(t,g,e),e},i=function(t){return l(t,g)?t[g]:{}},o=function(t){return l(t,g)}}t.exports={set:n,get:i,has:o,enforce:function(t){return o(t)?i(t):n(t,{})},getterFor:function(t){return function(e){var r;if(!s(e)||(r=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},function(t,e,r){var n=r(4),i=r(29),o=n.WeakMap;t.exports="function"==typeof o&&/native code/.test(i.call(o))},function(t,e,r){var n=r(9),i=r(64),o=r(22),a=r(15);t.exports=function(t,e){for(var r=i(e),u=a.f,s=o.f,c=0;c<r.length;c++){var l=r[c];n(t,l)||u(t,l,s(e,l))}}},function(t,e,r){var n=r(32),i=r(66),o=r(69),a=r(11);t.exports=n("Reflect","ownKeys")||function(t){var e=i.f(a(t)),r=o.f;return r?e.concat(r(t)):e}},function(t,e,r){t.exports=r(4)},function(t,e,r){var n=r(33),i=r(18).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,r){var n=r(14),i=r(13),o=r(68),a=function(t){return function(e,r,a){var u,s=n(e),c=i(s.length),l=o(a,c);if(t&&r!=r){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((t||l in s)&&s[l]===r)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,r){var n=r(19),i=Math.max,o=Math.min;t.exports=function(t,e){var r=n(t);return r<0?i(r+e,0):o(r,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(7),i=/#|\.prototype\./,o=function(t,e){var r=u[a(t)];return r==c||r!=s&&("function"==typeof e?n(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},u=o.data={},s=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},function(t,e,r){var n=r(7);t.exports=!!Object.getOwnPropertySymbols&&!n(function(){return!String(Symbol())})},function(t,e,r){r(49)("flatMap")},function(t,e,r){var n=r(11),i=r(74),o=r(18),a=r(17),u=r(76),s=r(28),c=r(30)("IE_PROTO"),l=function(){},f=function(){var t,e=s("iframe"),r=o.length;for(e.style.display="none",u.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),f=t.F;r--;)delete f.prototype[o[r]];return f()};t.exports=Object.create||function(t,e){var r;return null!==t?(l.prototype=n(t),r=new l,l.prototype=null,r[c]=t):r=f(),void 0===e?r:i(r,e)},a[c]=!0},function(t,e,r){var n=r(6),i=r(15),o=r(11),a=r(75);t.exports=n?Object.defineProperties:function(t,e){o(t);for(var r,n=a(e),u=n.length,s=0;u>s;)i.f(t,r=n[s++],e[r]);return t}},function(t,e,r){var n=r(33),i=r(18);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e,r){var n=r(32);t.exports=n("document","documentElement")},,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.r(e);var n=r(0),i=r.n(n),o=r(2),a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},s=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},l=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},f=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t},p=function(){function t(t,e){this.datasourceRequest=t,this.url=e}return t.prototype.ping=function(){return u(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/ping"})];case 1:return[2,t.sent()]}})})},t.prototype.query=function(t){return u(this,void 0,void 0,function(){var e,r;return s(this,function(n){switch(n.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/query",params:{expr:t}})];case 1:return e=n.sent(),r=e.data,[2,i.a.isArray(r)?r:[]]}})})},t.prototype.descs=function(t){return u(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/descs",params:{series:t.join(",")}})];case 1:return[2,e.sent().data]}})})},t.prototype.instances=function(t){return u(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/instances",params:{series:t.join(",")}})];case 1:return[2,e.sent().data]}})})},t.prototype.values=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,function(){var r,n;return s(this,function(o){switch(o.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/values",params:a({series:t.join(",")},e)})];case 1:return r=o.sent(),n=r.data,[2,i.a.isArray(n)?n:[]]}})})},t.prototype.metrics=function(t){return u(this,void 0,void 0,function(){var e,r;return s(this,function(n){switch(n.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/metrics",params:{match:t}})];case 1:return e=n.sent(),r=e.data,[2,i.a.isArray(r)?r:[]]}})})},t.prototype.labels=function(t){return u(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.datasourceRequest({url:this.url+"/series/labels",params:{series:t.join(",")}})];case 1:return[2,e.sent().data]}})})},t}(),h=function(){function t(t,e){this.descriptionCache={},this.instanceCache={},this.labelCache={},this.metricNamesCache={},this.pmSeriesApi=new p(t,e)}return t.prototype.ping=function(){return u(this,void 0,void 0,function(){return s(this,function(t){return[2,this.pmSeriesApi.ping()]})})},t.prototype.query=function(t){return u(this,void 0,void 0,function(){return s(this,function(e){return[2,this.pmSeriesApi.query(t)]})})},t.prototype.getDescriptions=function(t){return u(this,void 0,void 0,function(){var e,r,n,o,a,u,l;return s(this,function(s){switch(s.label){case 0:return(e=i.a.difference(t,Object.keys(this.descriptionCache))).length>0?[4,this.pmSeriesApi.descs(e)]:[3,2];case 1:r=s.sent();try{for(n=c(r),o=n.next();!o.done;o=n.next())a=o.value,this.descriptionCache[a.series]=a}catch(t){u={error:t}}finally{try{o&&!o.done&&(l=n.return)&&l.call(n)}finally{if(u)throw u.error}}s.label=2;case 2:return[2,i.a.pick(this.descriptionCache,t)]}})})},t.prototype.getInstances=function(t,e){return void 0===e&&(e=!1),u(this,void 0,void 0,function(){var r,n,o,a,u,l,f,p,h,v,y,d;return s(this,function(s){switch(s.label){case 0:return(r=e?t:i.a.difference(t,Object.keys(this.instanceCache))).length>0?[4,this.pmSeriesApi.instances(r)]:[3,2];case 1:n=s.sent();try{for(o=c(r),a=o.next();!a.done;a=o.next())u=a.value,this.instanceCache[u]={}}catch(t){h={error:t}}finally{try{a&&!a.done&&(v=o.return)&&v.call(o)}finally{if(h)throw h.error}}try{for(l=c(n),f=l.next();!f.done;f=l.next())p=f.value,this.instanceCache[p.series][p.instance]=p}catch(t){y={error:t}}finally{try{f&&!f.done&&(d=l.return)&&d.call(l)}finally{if(y)throw y.error}}s.label=2;case 2:return[2,i.a.pick(this.instanceCache,t)]}})})},t.prototype.getInstance=function(t,e,r){return void 0===r&&(r=!1),u(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return t in this.instanceCache&&e in this.instanceCache[t]||r?[3,2]:[4,this.getInstances([t],!0)];case 1:n.sent(),n.label=2;case 2:return[2,(this.instanceCache[t]||{})[e]]}})})},t.prototype.getValues=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,function(){return s(this,function(r){return[2,this.pmSeriesApi.values(t,e)]})})},t.prototype.getMetrics=function(t){return u(this,void 0,void 0,function(){var e,r;return s(this,function(n){switch(n.label){case 0:return t in this.metricNamesCache?[3,2]:(e=this.metricNamesCache,r=t,[4,this.pmSeriesApi.metrics(t)]);case 1:e[r]=n.sent(),n.label=2;case 2:return[2,this.metricNamesCache[t]]}})})},t.prototype.getLabels=function(t){return u(this,void 0,void 0,function(){var e,r,n,o,a,u;return s(this,function(s){switch(s.label){case 0:return i.a.difference(t,Object.keys(this.labelCache)).length>0?[4,this.pmSeriesApi.labels(t)]:[3,2];case 1:e=s.sent();try{for(r=c(e),n=r.next();!n.done;n=r.next())o=n.value,this.labelCache[o.series]=o.labels}catch(t){a={error:t}}finally{try{n&&!n.done&&(u=r.return)&&u.call(r)}finally{if(a)throw a.error}}s.label=2;case 2:return[2,i.a.pick(this.labelCache,t)]}})})},t.prototype.getMetricAndInstanceLabels=function(t){return u(this,void 0,void 0,function(){var e,r,n,o,a,u;return s(this,function(s){switch(s.label){case 0:return[4,this.getDescriptions(t)];case 1:return e=s.sent(),r=l(i.a.partition(t,function(t){return"none"!==e[t].indom}),2),n=r[0],o=r[1],a=[],n.length>0?[4,this.getInstances(n)]:[3,3];case 2:u=s.sent(),a=Object.values(u).flatMap(Object.keys),s.label=3;case 3:return[4,this.getLabels(f(o,a))];case 4:return[2,s.sent()]}})})},t.prototype.getQualifiers=function(t){return u(this,void 0,void 0,function(){var e,r,n,i,o,a,u,f,p,h,v,y,d,m,g,b,x,w,S;return s(this,function(s){switch(s.label){case 0:return[4,this.query(t)];case 1:return 0===(e=s.sent()).length?[2,{}]:(r={},[4,this.getDescriptions(e)]);case 2:return n=s.sent(),(i=e.filter(function(t){return"none"!==n[t].indom})).length>0?[4,this.getInstances(i)]:[3,4];case 3:o=s.sent(),r["instance.name"]=Object.values(o).flatMap(Object.values).map(function(t){return t.name}),s.label=4;case 4:return[4,this.getMetricAndInstanceLabels(e)];case 5:a=s.sent();try{for(u=c(Object.values(a)),f=u.next();!f.done;f=u.next()){p=f.value;try{for(w=void 0,h=c(Object.entries(p)),v=h.next();!v.done;v=h.next())y=l(v.value,2),d=y[0],m=y[1],g=m.toString(),d in r||(r[d]=[]),r[d].includes(g)||r[d].push(g)}catch(t){w={error:t}}finally{try{v&&!v.done&&(S=h.return)&&S.call(h)}finally{if(w)throw w.error}}}}catch(t){b={error:t}}finally{try{f&&!f.done&&(x=u.return)&&x.call(u)}finally{if(b)throw b.error}}return[2,r]}})})},t}(),v=r(38),y=r(39),d=r(40),m=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},g=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},b=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},x=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},w=function(){function t(t,e,r){this.instanceSettings=t,this.backendSrv=e,this.templateSrv=r,this.name=t.name,this.withCredentials=t.withCredentials,this.headers={"Content-Type":"application/json"},"string"==typeof t.basicAuth&&t.basicAuth.length>0&&(this.headers.Authorization=t.basicAuth),this.transformations=new v.a(this.templateSrv),this.pmSeriesSrv=new h(this.doRequest.bind(this),this.instanceSettings.url)}return t.$inject=["instanceSettings","backendSrv","templateSrv"],t.prototype.doRequest=function(t){return m(this,void 0,void 0,function(){var e;return g(this,function(r){switch(r.label){case 0:t.withCredentials=this.withCredentials,t.headers=this.headers,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.backendSrv.datasourceRequest(t)];case 2:return[2,r.sent()];case 3:throw e=r.sent(),new d.a(e);case 4:return[2]}})})},t.prototype.testDatasource=function(){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:if(Object(o.b)(this.instanceSettings.url))return[2,{status:"error",message:"Please specify a URL in the datasource settings."}];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.pmSeriesSrv.ping()];case 2:if(200!==t.sent().status)throw{message:"Invalid response code returned from datasource"};return[2,{status:"success",message:"Data source is working"}];case 3:return[2,{status:"error",message:t.sent().message}];case 4:return[2]}})})},t.prototype.metricFindQuery=function(t){return m(this,void 0,void 0,function(){var e,r,n,i,o,a,u,s;return g(this,function(c){switch(c.label){case 0:return t=this.templateSrv.replace(t),e=/^metrics\(([a-zA-Z0-9._*]*)\)$/,r=/^label_values\(([a-zA-Z][a-zA-Z0-9._]*),\s*(\S+)\)$/,(n=t.match(e))?(i=""===n[1]?"*":n[1],[4,this.pmSeriesSrv.getMetrics(i)]):[3,2];case 1:return[2,c.sent().map(function(t){return{text:t,value:t}})];case 2:return(o=t.match(r))?(a=b(o,3),u=a[1],s=a[2],[4,this.pmSeriesSrv.getQualifiers(u)]):[3,4];case 3:return[2,(c.sent()[s]||[]).map(function(t){return{text:t,value:t}})];case 4:return[2,[]]}})})},t.prototype.buildQueryTargets=function(t){var e=this;return t.targets.filter(function(t){return!t.hide&&!Object(o.b)(t.expr)&&!t.isTyping}).map(function(r){return{refId:r.refId,expr:e.templateSrv.replace(r.expr.trim(),t.scopedVars),format:r.format,legendFormat:r.legendFormat}})},t.prototype.handleTarget=function(t,e,r,n){return m(this,void 0,void 0,function(){var o,a,u,s,c,l,f,p,h,v,d,m,b,x;return g(this,function(g){switch(g.label){case 0:for(u in o=[],a=[],t)a.push(u);s=0,g.label=1;case 1:if(!(s<a.length))return[3,8];for(h in c=a[s],l=[],f=i.a.groupBy(t[c],function(t){return t.instance||""}),p=[],f)p.push(h);v=0,g.label=2;case 2:return v<p.length?(d=p[v],m=f[d].map(function(t){return[parseFloat(t.value),t.timestamp]}),b="",""===d?[3,4]:[4,this.pmSeriesSrv.getInstance(c,d)]):[3,6];case 3:(x=g.sent())&&(b=x.name),g.label=4;case 4:l.push({id:d,name:b,values:y.a.applyTransformations(n.format,e[c].semantics,e[c].units,m),labels:""!==d?r[d]:r[c]}),g.label=5;case 5:return v++,[3,2];case 6:o.push({name:n.expr,instances:l}),g.label=7;case 7:return s++,[3,1];case 8:return[2,{target:n,metrics:o}]}})})},t.defaultLegendFormatter=function(t,e,r){var n,o,a=e&&null!==e.id?e.name:t;if(!i.a.isEmpty(r)){var u=[];try{for(var s=x(["hostname","source"]),c=s.next();!c.done;c=s.next()){var l=c.value;l in r&&u.push(l+': "'+r[l]+'"')}}catch(t){n={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}u.length>0&&(a+=" {"+u.join(", ")+"}")}return a},t.prototype.query=function(e){return m(this,void 0,void 0,function(){var r,n,o,a,u,s,c,l,f,p,h,v,y,d,m=this;return g(this,function(g){switch(g.label){case 0:if(0===(r=this.buildQueryTargets(e)).length)return[2,{data:[]}];if(!i.a.every(r,["format",r[0].format]))throw new Error("Format must be the same for all queries of a panel.");return n=r.map(function(t){return t.expr}),[4,Promise.all(n.map(function(t){return m.pmSeriesSrv.query(t)}))];case 1:for(s in o=g.sent(),a=i.a.zipObject(n,o),u=o.flat(),a)if(0===a[s].length)throw new Error("Could not find any series for "+s);return 10,c=Math.round(e.range.from.valueOf()/1e3)-20,l=Math.round(e.range.to.valueOf()/1e3)+10,f=Math.round((e.range.to.valueOf()-e.range.from.valueOf())/e.intervalMs),[4,this.pmSeriesSrv.getValues(u,{start:c,finish:l,samples:f})];case 2:return p=g.sent(),[4,this.pmSeriesSrv.getDescriptions(u)];case 3:return h=g.sent(),v=i.a.groupBy(p,"series"),y=this.pmSeriesSrv.getMetricAndInstanceLabels(u),[4,Promise.all(r.map(function(t){return m.handleTarget(i.a.pick(v,a[t.expr]),h,y,t)}))];case 4:return d=g.sent(),[2,{data:this.transformations.transform(e,d,t.defaultLegendFormatter)}]}})})},t}(),S=r(41),T=function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},O=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},C=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},_=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(C(arguments[e]));return t},j=function(){function t(t,e){this.dashboardVariables=e,this.identifierRegexps=[/[\{"]/,/[a-zA-Z0-9_.]/],this.pmSeriesSrv=t.pmSeriesSrv}return t.prototype.getCompletions=function(t,e,r,n,i){this.findCompletions(t,e,r,n).then(function(t){i(null,t)},function(t){i(t,[])})},t.prototype.getCompletion=function(t,e,r){return{caption:t,value:e+t,meta:r,score:Number.MAX_VALUE}},t.prototype.findToken=function(t,e){for(var r=t.length-1;r>=0;r--)if(t[r].type===e)return t[r];return null},t.prototype.findMetricCompletions=function(t){return T(this,void 0,void 0,function(){var e,r,n=this;return O(this,function(i){switch(i.label){case 0:return e=t.value.substring(0,1),[4,this.pmSeriesSrv.getMetrics(e+"*")];case 1:return(r=i.sent()).sort(),[2,r.map(function(t){return n.getCompletion(t,"","metric")})]}})})},t.prototype.findQualifiersForToken=function(t){return T(this,void 0,void 0,function(){var e,r,n,i;return O(this,function(o){switch(o.label){case 0:return e=this.dashboardVariables.map(function(t){return"$"+t}),[4,this.pmSeriesSrv.getQualifiers(t)];case 1:for(n in r=o.sent())(i=r[n]).unshift.apply(i,_(e));return[2,r]}})})},t.prototype.getQualifierMetaTag=function(t,e){return e?e.startsWith("$")?"dashboard variable":"instance.name"===t?"instance name":"label value":"instance.name"===t?"instance name":"label"},t.prototype.findQualifierKeyCompletions=function(t,e){return T(this,void 0,void 0,function(){var r,n,i,o=this;return O(this,function(a){switch(a.label){case 0:return r="{"===e.value?"{":"",(n=this.findToken(t,"entity.name.tag.metric"))?[4,this.findQualifiersForToken(n.value)]:[2,[]];case 1:return i=a.sent(),[2,Object.keys(i).map(function(t){return o.getCompletion(t,r,o.getQualifierMetaTag(t))})]}})})},t.prototype.findQualifierValueCompletions=function(t,e){return T(this,void 0,void 0,function(){var r,n,i,o=this;return O(this,function(a){switch(a.label){case 0:return r='""'===e.value?'"':"",n=this.findToken(t,"entity.name.tag.metric"),i=this.findToken(t,"entity.name.tag.qualifier-key"),n&&i?[4,this.findQualifiersForToken(n.value)]:[2,[]];case 1:return[2,(a.sent()[i.value]||[]).map(function(t){return o.getCompletion(t,r,o.getQualifierMetaTag(i.value,t))})]}})})},t.prototype.findCompletions=function(t,e,r,n){return T(this,void 0,void 0,function(){var t;return O(this,function(n){return"entity.name.tag.metric"===(t=e.getTokenAt(r.row,r.column)).type?[2,this.findMetricCompletions(t)]:"entity.name.tag.qualifier-key"===t.type||"paren.lparen.qualifiers-matcher"===t.type?[2,this.findQualifierKeyCompletions(e.getTokens(r.row),t)]:"string.quoted.qualifier-value"===t.type?[2,this.findQualifierValueCompletions(e.getTokens(r.row),t)]:[2,[]]})})},t}(),k=r(1);var M,A=(M=function(t,e){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}M(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),P=function(t){function e(e,r,n){var i=t.call(this,e,r)||this;return i.variableSrv=n,i.formats=[],i.target.expr=i.target.expr||"",i.target.format=i.target.format||i.getDefaultFormat(),i.formats=[{text:"Time series",value:k.a.TimeSeries},{text:"Table",value:k.a.MetricsTable},{text:"Heatmap",value:k.a.Heatmap}],i}return e.$inject=["$scope","$injector","variableSrv"],A(e,t),e.prototype.getDefaultFormat=function(){return"table"===this.panelCtrl.panel.type?k.a.MetricsTable:"heatmap"===this.panelCtrl.panel.type?k.a.Heatmap:k.a.TimeSeries},e.prototype.getCompleter=function(){this.removeTextCompleter("pmseries"),function(t){t.define("ace/snippets/pmseries",["require","exports","module"],function(t,e,r){e.snippets=[],e.scope="pmseries"}),t.define("ace/mode/pmseries_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(t,e,r){var n=t("../lib/oop"),i=t("./text_highlight_rules").TextHighlightRules,o=function(){this.$rules={start:[{token:"entity.name.tag.metric",regex:"[a-zA-Z][a-zA-Z0-9._]*"},{token:"paren.lparen.qualifiers-matcher",regex:"{",next:"start-qualifiers-matcher"}],"start-qualifiers-matcher":[{token:"entity.name.tag.qualifier-key",regex:"[a-zA-Z_][a-zA-Z0-9_.]*"},{token:"keyword.operator",regex:"==|!=|~~|=~|!~|:|<|>|<=|>="},{token:"string.quoted.qualifier-value",regex:'".*?"'},{token:"punctuation.operator",regex:"&&|\\|\\||,"},{token:"paren.rparen",regex:"}",next:"start"}]},this.normalizeRules()};n.inherits(o,i),e.PmSeriesHighlightRules=o}),t.define("ace/mode/pmseries",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/pmseries_highlight_rules"],function(t,e,r){var n=t("../lib/oop"),i=t("./text").Mode,o=t("./pmseries_highlight_rules").PmSeriesHighlightRules,a=function(){this.HighlightRules=o,this.$behaviour=this.$defaultBehaviour};n.inherits(a,i),function(){this.$id="ace/mode/pmseries"}.call(a.prototype),e.Mode=a})}(window.ace);var t=Object.keys(Object(o.a)(this.variableSrv));return new j(this.datasource,t)},e.templateUrl="datasources/redis/partials/query.editor.html",e}(S.a);r.d(e,"ConfigCtrl",function(){return q}),r.d(e,"AnnotationsQueryCtrl",function(){return E}),r.d(e,"Datasource",function(){return w}),r.d(e,"QueryCtrl",function(){return P});var q=function(){function t(){}return t.templateUrl="datasources/redis/partials/config.html",t}(),E=function(){function t(){}return t.templateUrl="datasources/redis/partials/annotations.editor.html",t}()}])});
//# sourceMappingURL=module.js.map